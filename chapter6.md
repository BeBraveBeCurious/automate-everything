# 到处都是测试

测试在软件开发中的位置可谓举足轻重。几乎所有讲软件工程的书都会提到并且强调其重要性。测试在构建软件的作用非常明显，尤其是当你构建大型应用的时候。

本篇文章主要由四部分组成：

- 什么是测试
- 为什么要测试
- 测试的方法
- 自动化测试

## 什么是测试

> 测试就是保证你的代码按照预期运行的代码。

测试就是代码，和普通代码除了功能之外没有区别。
测试的功能就是确保被测试的代码按照预期运行。

如何`确保`呢？ 通过`断言`。
怎么才能`按照预期`呢？ 这就需要你充分考虑业务场景了。 `高的测试覆盖率`是优秀代码的特征。 如果你实现不知道怎么测试，那就先提高你的测试覆盖率吧。

### 什么是测试覆盖率

> 高的测试覆盖率并不能反应代码质量高

高的测试覆盖率是好的代码的必要条件，因此想写好代码，先把你的测试覆盖率提高再说吧。

`测试用例`会收集包括软件哪一部分，哪一个分支甚至哪一条语句执行的信息。

> 测试覆盖率是一个技术指标，用来衡量被测试代码占所有代码的比例。

如下是我写的一个 sample 的测试覆盖率报告：

![测试报告](https://github.com/azl397985856/automate-everything/blob/master/illustrations/%E5%9B%BE6.1.png)

这里测试覆盖率有了更多的精细化的技术指标： 比如语句覆盖率（Stmts），分支覆盖率（Branch），函数覆盖率（Funcs），行数覆盖率（Lines），未被覆盖的行（Uncovered Line）等。这些指标通过名字就大概能看出含义。

## 为什么要测试
### 让自己安心
测试可以让你安心，它给你自信，它告诉你“嗯！你的代码没有问题”，它给了你
自信，这样的信息在构建大型项目是很重要的。

我的编程习惯是文档驱动，测试驱动，也就是说在做一个需求之前，先写下文档然后写测试用例，再写下实现的步骤（TODO），最终填充代码实现。这个模式可能和大家的编程习惯不太一样，甚至是完全相反的。 不过从我的经验来看，这个习惯给我带来了很多好处，我希望你也可以尝试一下。

### 让别人安心
程序员最不愿意做的事情除了临时需求变更之外恐怕就是改别人的代码了。
改别人的代码需要充分了解当时的场景，包括业务，基本假设是什么，除此之外还要看懂别人的每一行代码，我们才有信息去更改别人的代码。这是一个非常痛苦的过程。有了测试了用例情况就有所不同了。

在测试用例写的足够完善的情况下，他们只要保证改了代码测试用例可以通过了，
他们就有信息去修改你的代码了。

### 安心发布
如果没有测试用例，发布新的功能和修复一个线上bug是非常痛苦的。
毕竟修复一个bug，引入两个bug的梗不止一次地出现在我们的真实生活之中。
你如果非常了解这个项目倒还好，如果不呢？ 
这会让你举步维艰，仿佛陷入了一个无尽的沼泽。
因此完善的测试确实可以让你放心的按下确认发布按钮。

尤其是在敏捷团队中，发布和修复线上bug是一个非常频繁的操作，你如果不希望天天提心吊胆修改代码，那么从现在开始完善你的测试用例吧！

### 帮助别人快速了解系统
如果你不想从头到尾把代码看一遍。那么直接去看测试用例往往是一个快速的方式。
从测试用例我们不仅可以看到代码有哪些功能，我们设置可以看到代码能够处理的和不能处理的东西。
这些东西都是一目了然的。
我甚至在接手一个项目之前会优先看他的package.json和test文件夹。
> 前者可以看出项目的依赖组成，有哪些脚本。 后者可以看出项目具体的功能点
